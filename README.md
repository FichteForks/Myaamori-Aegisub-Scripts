# Myaamori's Script Collection

## Merge Scripts

### Overview

![overview](https://raw.githubusercontent.com/TypesettingTools/Myaamori-Aegisub-Scripts/master/assets/ms_overview.png)

Merge Scripts is an advanced bi-directional script merger.
It allows you to define a set of imports in an ASS file, which can then be used to import and de-import other files, as well as export any changes to the original files.
This is particularly useful when you are using a VCS such as git to store your files in a modular layout, where e.g. dialogue, songs and typesetting are stored in separate files and where the filenames don't change.
In such a scenario, you only need to define the imports once, after which all scripts can be re-merged in a single click anytime something is changed.
No more manually having to merge and shift songs every time you change something in the OP!
The ability to export changes also means that the modular structure can be kept, while still allowing for e.g. easy QC from a single file.

### Importing files

To import files you must first create an import definition.
Merge Scripts can do this for you using the **Add file to include** option.
Simply select the file or files that you wish to include, and import definitions will be added for you at the end of the file.

![overview](https://raw.githubusercontent.com/TypesettingTools/Myaamori-Aegisub-Scripts/master/assets/ms_importdef.png)

This script contains import definitions for three files: `shoujo kageki 03.ass`, `insert 03.ass`, and `signs 03.ass`.
In order to actually import the files, we use the **Import all external files** option.
This will read the files specified in the import definitions and add their styles and dialogue lines to the current script.

![after import](https://raw.githubusercontent.com/TypesettingTools/Myaamori-Aegisub-Scripts/master/assets/ms_postimport.png)

Every style will be prefixed with an identifier to keep track of what file the line came from.
Files can be imported selectively using **Import selected external file(s)**, which will only import files corresponding to the currently selected import definitions.

Once files have been imported, they can be de-imported to get back the original file prior to importing using the **Remove all external files** option.
This will delete all lines that belong to imported files.
Much like with importing, you can remove files selectively using **Remove selected external file(s)**, which will only remove the file corresponding to the currently selected files (you may select either the import definition or any line from the file you wish to remove).

### Exporting changes

The **Export changes** option allows you to export any changes you've made to the lines to their original files.
You will get a warning showing what files will be overwritten upon export.
Note that the script will currently *not* export script properties, but will leave the Script Info and Aegisub Project Garbage sections as they were in the source file.
Export changes will keep any extradata generated by automations intact.

### Shifted imports

![shifted import](https://raw.githubusercontent.com/TypesettingTools/Myaamori-Aegisub-Scripts/master/assets/ms_shiftedimport.png)

Shifted imports automatically shift the lines in the imported file so that the start time of an synchronization line in the external file matches the start time of the import definition.
Run **Add synchronization line for shifted imports** on the file to import to add a new synchronization line at the current video time, and **Add file to include (shifted)** to add a shifted import definition at the current video time.

When exporting changes to a shifted file, the timings will be shifted back to match the original position of the synchronization line.
This means that shifting the lines will not affect the timing in the source file, however relative adjustments to individual lines such as fixed scene bleeds will be exported.

### Conflicting script properties on import

![conflicting properties](https://raw.githubusercontent.com/TypesettingTools/Myaamori-Aegisub-Scripts/master/assets/ms_conflict.png)

When importing files, Merge Scripts will set script properties such as the resolution of the current script to match the imported files.
However, if there are conflicting values among the imported scripts, Merge Scripts will warn about this and let you choose which value to use.
If you hover over the dropdown box you can see the corresponding value from each individual file.
Note that **Merge Scripts will not attempt to resample the lines based on your selection**.
Thus, in the event of a conflict it is usually best to correct the offending file first.

### Generating a release version

Since you may not want to release the script publicly with all styles prefixed and the import definitions included (not that it would affect the viewing experience in any way), Merge Scripts also provides the **Generate release candidate** option.
This will remove the prefixes from all styles, remove unused styles, and remove all commented lines.
It will also warn about conflicting style names.

## Sub Digest


